-- 准备企业基础信息表

-- ===========================
-- 企业基础信息
-- ===========================

-- 创建 company 表
DROP TABLE IF EXISTS company;

CREATE TABLE company AS
SELECT
    reg_org,            -- 登记机关
    comp_type,          -- 企业类型大类（中文）
    reg_state,          -- 登记状态（中文）
    uni_social_crd_cd,  -- 统一社会信用代码
    comp_nm,            -- 企业名称（字号名称）
    addr,               -- 住所（登记、个体户经营场所）
    legal_repre,        -- 法定代表人(经营者姓名)
    indv_id,            -- 行业代码（中文）
    reg_capt,           -- 注册资本(资金数额)
    capt_kind,          -- 币种
    opt_scop,           -- 经营范围
    reg_no,             -- 注册号
    appr_dt,            -- 核准日期（登记、吊销、注销日期）
    est_dt,             -- 成立日期
    opt_from,           -- 经营(营业)起始日期
    opt_to,             -- 经营(营业)截止日期
    domdi_strict,       -- 住所所在行政区划
    -- pro_loc,            -- 生产经营地
    opt_strict,         -- 生产经营地所在行政区划
    postal_code,        -- 邮政编码
    -- opt_loc,            -- 经营场所
    indv_nm             -- 行业代码（中文）
FROM
    dw_zj_scjdgl_scztxx
WHERE
    indv_nm IN (
        -- 文旅行业代码列表
        '0141', '0143', '0149', '0151', '0152', '0153', '0154', '0159',
        '0412', '1784', '1922', '2221', '2222', '2311', '2312', '2319',
        '2320', '2330', '2411', '2412', '2414', '2421', '2422', '2423',
        '2429', '2431', '2432', '2433', '2434', '2435', '2436', '2437',
        '2438', '2439', '2441', '2442', '2449', '2451', '2452', '2453',
        '2454', '2455', '2456', '2459', '2461', '2462', '2469', '2642',
        '2644', '2664', '2672', '3075', '3076', '3471', '3472', '3473',
        '3474', '3542', '3733', '3780', '3873', '3931', '3932', '3933',
        '3934', '3939', '3951', '3952', '3953', '3961', '3963', '3969',
        '5137', '5141', '5143', '5144', '5145', '5146', '5147', '5149',
        '5175', '5178', '5181', '5183', '5184', '5211', '5212', '5213',
        '5219', '5221', '5222', '5223', '5224', '5225', '5226', '5227',
        '5229', '5231', '5232', '5233', '5234', '5235', '5236', '5237',
        '5238', '5239', '5241', '5242', '5243', '5244', '5245', '5246',
        '5247', '5248', '5249', '5261', '5262', '5263', '5264', '5265',
        '5266', '5267', '5271', '5311', '5312', '5313', '5331', '5333',
        '5339', '5411', '5412', '5413', '5414', '5419', '5421', '5422',
        '5429', '5441', '5442', '5443', '5449', '5511', '5512', '5513',
        '5531', '5539', '5611', '5622', '5631', '5632', '5639', '5822',
        '5910', '6110', '6121', '6129', '6130', '6140', '6190', '6210',
        '6220', '6231', '6232', '6233', '6239', '6241', '6291', '6319',
        '6321', '6322', '6331', '6421', '6422', '6429', '6432', '6434',
        '6439', '6440', '6450', '6513', '6572', '6579', '6621', '6623',
        '6624', '6629', '6634', '6635', '6636', '6637', '6639', '6813',
        '6814', '6820', '6999', '7111', '7115', '7119', '7121', '7122',
        '7123', '7124', '7125', '7129', '7130', '7211', '7212', '7215',
        '7219', '7221', '7222', '7223', '7224', '7229', '7251', '7259',
        '7271', '7272', '7281', '7282', '7283', '7284', '7289', '7291',
        '7294', '7297', '7298', '7299', '7350', '7484', '7491', '7492',
        '7520', '7711', '7712', '7713', '7714', '7715', '7716', '7719',
        '7850', '7861', '7862', '7869', '8051', '8052', '8053', '8060',
        '8070', '8336', '8341', '8342', '8391', '8393', '8399', '8412',
        '8413', '8414', '8415', '8416', '8511', '8512', '8610', '8621',
        '8622', '8623', '8624', '8625', '8626', '8629', '8710', '8720',
        '8730', '8740', '8750', '8760', '8770', '8810', '8820', '8831',
        '8832', '8840', '8850', '8860', '8870', '8890', '8921', '8929',
        '8930', '9011', '9012', '9013', '9019', '9020', '9030', '9051',
        '9053', '9059', '9090', '9221', '9222', '9521', '9522', '9542'
    )
    AND (
        opt_scop LIKE '%文化%' OR
        opt_scop LIKE '%多媒体%' OR
        opt_scop LIKE '%游戏%' OR
        opt_scop LIKE '%动漫%' OR
        opt_scop LIKE '%数字出版%' OR
        opt_scop LIKE '%建筑设计%' OR
        opt_scop LIKE '%舞台%' OR
        opt_scop LIKE '%婚庆%' OR
        opt_scop LIKE '%娱乐%' OR
        opt_scop LIKE '%版权%' OR
        opt_scop LIKE '%会议%' OR
        opt_scop LIKE '%展览%' OR
        opt_scop LIKE '%广告%' OR
        opt_scop LIKE '%工艺美术%' OR
        opt_scop LIKE '%旅游%' OR
        opt_scop LIKE '%出行%' OR
        opt_scop LIKE '%游客%' OR
        opt_scop LIKE '%观光%' OR
        opt_scop LIKE '%游览%' OR
        opt_scop LIKE '%旅行%' OR
        opt_scop LIKE '%体育%' OR
        opt_scop LIKE '%休闲%' OR
        opt_scop LIKE '%公共交通%' OR
        opt_scop LIKE '%健康%' OR
        opt_scop LIKE '%休养%' OR
        opt_scop LIKE '%会展%' OR
        opt_scop LIKE '%翻译%' OR
        opt_scop LIKE '%健身%' OR
        opt_scop LIKE '%保健%' OR
        opt_scop LIKE '%酒店%'
    )
ORDER BY uni_social_crd_cd;

-- 显示创建结果
SELECT
    COUNT(*) AS company
    COUNT(DISTINCT indv_nm) AS unique_indv_nm,
    COUNT(DISTINCT comp_type) AS unique_company_types,
    COUNT(DISTINCT domdi_strict) AS unique_districts
FROM
    company;

-- 显示表结构
DESCRIBE company;

-- 显示前10条记录
SELECT * FROM company LIMIT 10;

-- 查看 reg_state 的所有可能值
SELECT DISTINCT reg_state FROM company ORDER BY reg_state;

-- 统计每种 reg_state 的数量
SELECT reg_state, COUNT(*) AS count_per_state FROM company GROUP BY reg_state ORDER BY count_per_state DESC;

-- ===========================
-- 企业核心信息
-- ===========================

-- 创建企业核心信息表
DROP TABLE IF EXISTS company_core;

CREATE TABLE company_core AS
SELECT
    comp_type,          -- 企业类型大类（中文）
    reg_state,          -- 登记状态（中文）
    uni_social_crd_cd,  -- 统一社会信用代码
    comp_nm,            -- 企业名称（字号名称）
    addr,               -- 住所（登记、个体户经营场所）
    indv_id,            -- 行业代码（中文）
    reg_capt,           -- 注册资本(资金数额)
    est_dt,             -- 成立日期
    opt_strict,         -- 生产经营地所在行政区划
    indv_nm             -- 行业代码（中文）
FROM company;

COUNT(*) as core_count FROM company_core;

DESCRIBE company_core;

SELECT * FROM company_core LIMIT 10;

-- =========================
-- 文化企业
-- =========================

DROP TABLE IF EXISTS wenhua;

CREATE TABLE wenhua AS
SELECT * FROM company_core
WHERE indv_nm IN (
    '2221', '2222', '2311', '2312', '2319', '2320', '2330', '2411',
    '2412', '2414', '2421', '2422', '2423', '2429', '2431', '2432',
    '2433', '2434', '2435', '2436', '2437', '2438', '2439', '2451',
    '2452', '2453', '2454', '2455', '2456', '2459', '2461', '2462',
    '2469', '2642', '2644', '2664', '2672', '3075', '3076', '3471',
    '3472', '3474', '3542', '3873', '3931', '3932', '3933', '3934',
    '3939', '3951', '3952', '3953', '3961', '3963', '3969', '5137',
    '5141', '5143', '5144', '5145', '5146', '5147', '5149', '5175',
    '5178', '5181', '5183', '5184', '5241', '5243', '5244', '5245',
    '5246', '5247', '5248', '5249', '5271', '6319', '6321', '6322',
    '6331', '6421', '6422', '6429', '6513', '6572', '6579', '7124',
    '7125', '7211', '7212', '7221', '7251', '7259', '7281', '7282',
    '7283', '7284', '7289', '7350', '7484', '7491', '7492', '7520',
    '7861', '7862', '7869', '8070', '8393', '8399', '8610', '8621',
    '8622', '8623', '8624', '8625', '8626', '8629', '8710', '8720',
    '8730', '8740', '8750', '8760', '8770', '8831', '8832', '8870',
    '8890', '9013', '9051', '9053', '9059', '9521'
    );

-- =========================
-- 旅游企业
-- =========================

DROP TABLE IF EXISTS lvyou;

CREATE TABLE lvyou AS
select * from company_core
where indv_nm IN (
    '0141', '0143', '0149', '0151', '0152', '0153', '0154', '0159',
    '0412', '1784', '1922', '2441', '2442', '2449', '2461', '2462',
    '2469', '3733', '3780', '5211', '5212', '5213', '5219', '5221',
    '5222', '5223', '5224', '5225', '5226', '5227', '5229', '5231',
    '5232', '5233', '5234', '5235', '5236', '5237', '5238', '5239',
    '5242', '5261', '5262', '5263', '5264', '5265', '5266', '5267',
    '5311', '5312', '5313', '5331', '5333', '5339', '5411', '5412',
    '5413', '5414', '5419', '5421', '5422', '5429', '5441', '5442',
    '5443', '5449', '5511', '5512', '5513', '5531', '5539', '5611',
    '5631', '5632', '5639', '5822', '5910', '6110', '6121', '6129',
    '6130', '6140', '6190', '6210', '6220', '6231', '6232', '6233',
    '6239', '6241', '6291', '6432', '6434', '6439', '6440', '6450',
    '6621', '6623', '6624', '6629', '6634', '6635', '6636', '6637',
    '6639', '6813', '6814', '6820', '6999', '7111', '7115', '7119',
    '7122', '7129', '7130', '7215', '7219', '7222', '7223', '7224',
    '7229', '7271', '7272', '7291', '7294', '7297', '7299', '7861',
    '7862', '7869', '8051', '8052', '8053', '8336', '8341', '8342',
    '8391', '8412', '8413', '8414', '8415', '8416', '8511', '8512',
    '8921', '8929', '8930', '8930', '9221', '9222', '9522', '9542'
    );

COUNT(*) as lvyou_count FROM lvyou;

-- =========================
-- 文旅融合企业
-- =========================

DROP TABLE IF EXISTS wenlv;

CREATE TABLE wenlv AS
select * from company_core
where indv_nm IN (
    '3473', '5622', '6432', '7121', '7123', '7298', '7711', '7712', '7713', '7714'
    '7715', '7716', '7719', '7850', '8060', '8810', '8820', '8840', '8850', '8860'
    '9011', '9012', '9019', '9020', '9030', '9090'
    );

COUNT(*) as wenlv_count FROM wenlv;

-- =========================
--
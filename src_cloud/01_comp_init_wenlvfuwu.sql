-- ===========================
-- 文旅服务业企业筛选查询
-- ===========================
-- 说明：从表 dw_zj_scjdgl_scztxx 中按两类条件筛选文旅服务业企业
-- 筛选条件：
-- 1. 行业代码(indv_nm)前两位在指定大类：'61','62','80','81','82','86','87','88','89','90'
-- 2. 行业代码(indv_nm)包含指定小类：'5422','5511','5512','5513','5531','5622','5822','6110','6121','6129','7850','7861','7862','7869','9020','8840','8850','9542','8860','7291'

-- 筛选文旅服务业企业
SELECT
    uni_social_crd_cd,  -- 统一社会信用代码
    comp_nm,            -- 企业名称（字号名称）
    indv_nm,            -- 行业代码
    comp_type,          -- 企业类型
    reg_state,          -- 登记状态
    addr,               -- 住所地址
    legal_repre,        -- 法定代表人
    est_dt,             -- 成立日期
    opt_strict          -- 生产经营地所在行政区划
FROM dw_zj_scjdgl_scztxx
WHERE
    (
        -- 条件1：行业代码前两位在指定大类集合内
        SUBSTRING(TRIM(indv_nm), 1, 2) IN (
            '61','62','80','81','82','86','87','88','89','90'
        )
        OR
        -- 条件2：行业代码包含指定小类代码
        TRIM(indv_nm) IN (
            '5422','5511','5512','5513','5531','5622','5822',
            '6110','6121','6129','7850','7861','7862','7869',
            '9020','8840','8850','9542','8860','7291'
        )
    )
ORDER BY uni_social_crd_cd;

COUNT(DISTINCT uni_social_crd_cd)